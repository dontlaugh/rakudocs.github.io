<!doctype html>
<html lang="en">
    <head>
        <title>syntax token</title>
        <meta charset="UTF-8" />
        <style>
        kbd { font-family: "Droid Sans Mono", "Luxi Mono", "Inconsolata", monospace }
        samp { font-family: "Terminus", "Courier", "Lucida Console", monospace }
        u { text-decoration: none }
        .nested {
            margin-left: 3em;
        }
        aside, u { opacity: 0.7 }
        a[id^="fn-"]:target { background: #ff0 }
        </style>
        
        
        <meta name=viewport content="width=device-width, initial-scale=1">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/css/app.css?v=7" media="screen" title="default" />
<noscript> <style> #search { visibility: hidden; } </style> </noscript>

    </head>
    <body class="pod">
    <div id="___top"></div>
    <div id="header" class="pretty-box green">
  <a href="/"
    ><img
      src="/images/Camelia.svg"
      alt="»ö«"
      id="logo"
      width="62"
      height="48"
    />&nbsp;Perl 6 Documentation</a
  >
  <div id="search" class="ui-widget">
    <div class="green">
      <input
        placeholder="Loading..."
        id="query"
        accesskey="f"
        title="Enter term to search for (hit Esc to focus)"
      />
    </div>
    <p id="not-found-message">
      Not in Index (<a href="" id="try-web-search">try site search</a>)
    </p>
  </div>
  <div class="menu">
    <div class="menu-items dark-green"><a class='menu-item darker-green' href='https://perl6.org'><strong>Perl&nbsp;6 homepage</strong></a>  <a class="menu-item " href="/language.html"> Language </a> <a class="menu-item " href="/type.html"> Types </a> <a class="menu-item " href="/routine.html"> Routines </a> <a class="menu-item " href="/programs.html"> Programs </a> <a class="menu-item " href="https://webchat.freenode.net/?channels=#perl6"> Chat with us </a></div>
  </div>
</div>
<div id="content" class="pretty-box yellow content_fragment">
  

    <h1 class='title'>syntax token</h1>
    
    <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
    <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#language_documentation_Grammars">language documentation Grammars</a></td></tr>
   <tr class="toc-level-2"><td class="toc-number">1.1</td><td class="toc-text"><a href="#(Grammars)_declarator_token_token">(Grammars) declarator token token</a></td></tr>
                                                    <tr class="toc-level-2"><td class="toc-number">1.2</td><td class="toc-text"><a href="#Rules">Rules</a></td></tr>
                     
</table>
</nav>

    <div class="pod-body">
    <p>Documentation for syntax <code>token</code> assembled from the following types:</p>
<h1 id="language_documentation_Grammars"><a class="u" href="#___top" title="go to top of document">language documentation Grammars</a></h1>
<p>From <a href="/language/grammars#Named_Regexes">Grammars</a></p>
<h2 id="(Grammars)_declarator_token_token"><a href="/language/grammars#Named_Regexes">(Grammars) declarator token token</a></h2>
<p>The main ingredient of grammars is named <a href="/language/regexes">regexes</a>. While the syntax of <a href="/language/regexes">Perl&nbsp;6 Regexes</a> is outside the scope of this document, <em>named</em> regexes have a special syntax, similar to subroutine definitions: <a href="#fn-1" id="fn-ref-1">[1]</a></p>
<pre class="pod-block-code">my regex number { \d+ [ \. \d+ ]? }
</pre>
<p>In this case, we have to specify that the regex is lexically scoped using the <code>my</code> keyword, because named regexes are normally used within grammars.</p>
<p>Being named gives us the advantage of being able to easily reuse the regex elsewhere:</p>
<pre class="pod-block-code">say so &quot;32.51&quot; ~~ &amp;number;                         # OUTPUT: «True␤»
say so &quot;15 + 4.5&quot; ~~ /&lt;number&gt;\s* &#39;+&#39; \s*&lt;number&gt;/ # OUTPUT: «True␤»
</pre>
<p><strong><code>regex</code></strong> isn&#39;t the only declarator for named regexes. In fact, it&#39;s the least common. Most of the time, the <strong><code>token</code></strong> or <strong><code>rule</code></strong> declarators are used. These are both <em>ratcheting</em>, which means that the match engine won&#39;t back up and try again if it fails to match something. This will usually do what you want, but isn&#39;t appropriate for all cases:</p>
<pre class="pod-block-code">my regex works-but-slow { .+ q }
my token fails-but-fast { .+ q }
my $s = &#39;Tokens won\&#39;t backtrack, which makes them fail quicker!&#39;;
say so $s ~~ &amp;works-but-slow; # OUTPUT: «True␤»
say so $s ~~ &amp;fails-but-fast; # OUTPUT: «False␤»
                              # the entire string get taken by the .+
</pre>
<p>Note that non-backtracking works on terms, that is, as the example below, if you have matched something, then you will never backtrack. But when you fail to match, if there is another candidate introduced by <code>|</code> or <code>||</code>, you will retry to match again.</p>
<pre class="pod-block-code">my token tok-a { .* d  };
my token tok-b { .* d | bd };
say so &quot;bd&quot; ~~ &amp;tok-a;        # OUTPUT: «False␤»
say so &quot;bd&quot; ~~ &amp;tok-b;        # OUTPUT: «True␤»
</pre>
<h2 id="Rules"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-declarator_rule-Rules"><span class="index-entry">Rules</span></a></a></h2>
<p>The only difference between the <code>token</code> and <code>rule</code> declarators is that the <code>rule</code> declarator causes <a href="/language/regexes#Sigspace"><code>:sigspace</code></a> to go into effect for the Regex:</p>
<pre class="pod-block-code">my token non-space-y { &#39;once&#39; &#39;upon&#39; &#39;a&#39; &#39;time&#39; }
my rule space-y { &#39;once&#39; &#39;upon&#39; &#39;a&#39; &#39;time&#39; }
say so &#39;onceuponatime&#39;    ~~ &amp;non-space-y; # OUTPUT: «True␤»
say so &#39;once upon a time&#39; ~~ &amp;non-space-y; # OUTPUT: «False␤»
say so &#39;onceuponatime&#39;    ~~ &amp;space-y;     # OUTPUT: «False␤»
say so &#39;once upon a time&#39; ~~ &amp;space-y;     # OUTPUT: «True␤»
</pre>

    </div>
    <aside><ol start="1">
<li><a href="#fn-ref-1" id="fn-1">[↑]</a> In fact, named regexes can even take extra arguments, using the same syntax as subroutine parameter lists </li>
</ol></aside>

    </div>
<footer class="pretty-box yellow">
    <p>This is a work in progress to document Perl 6, and known to be
        incomplete.</p>
     <p><a href="https://github.com/perl6/doc/blob/master/CONTRIBUTING.md#reporting-bugs">Please report any issues</a>
      Your contribution is appreciated.</p>
  <p>
      This documentation is provided under the terms of the
      <a href="https://raw.githubusercontent.com/perl6/doc/master/LICENSE">Artistic License 2.0</a>.
      The Camelia image is <a href="https://raw.githubusercontent.com/perl6/mu/master/misc/camelia.txt"
        >copyright © 2009 by Larry Wall.</a>
      <!-- CREDITS -->
      <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->

  </p>
</footer>

<script type="text/javascript" src="/js/app.js?v=1"></script>
<script type="text/javascript" src="/js/search.js?v=3"></script>
    </body>
</html>
